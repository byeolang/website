<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>byeol: /Users/kniz/repo/byeolang/byeol/module/indep/macro/or.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<link type="text/css" rel="stylesheet" href="../../assets/css/galmuri.css" />
<script type="text/javascript" src="dynsections.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script type="text/javascript" src="https://github.com/byeolang/highlightjs-byeol/releases/download/v0.2.8/highlightjs-byeol-min.js"></script>
<script type="text/javascript" src="postprocess.js"></script>
<link href="highlightjs-theme-byeol.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="byeol.css" rel="stylesheet" type="text/css"/>
<link href="highlightjs-theme-byeol.css" rel="stylesheet" type="text/css"/>
<!-- extensions: -->
<!--    fragement copy to clipboard: -->
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<!--    paragraph linking: -->
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeParagraphLink.init()
</script>
<!--    interactive toc: -->
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeInteractiveToc.init()
</script>
<!-- end of extension -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('or_8hpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">or.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="to_8hpp_source.html">indep/macro/to.hpp</a>&quot;</code><br />
</div>
<p><a href="or_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structby_1_1____or_stack____.html">by::__orStack__</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9de3b2867e4ea8c08be077f49965cca8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="or_8hpp.html#a9de3b2867e4ea8c08be077f49965cca8">__OR_DO__</a>(_expr_)</td></tr>
<tr class="separator:a9de3b2867e4ea8c08be077f49965cca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf4a66cacaf720f99688a39b9bb0c0b9"><td class="memItemLeft" align="right" valign="top"><a id="acf4a66cacaf720f99688a39b9bb0c0b9" name="acf4a66cacaf720f99688a39b9bb0c0b9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OR_DO</b>&#160;&#160;&#160;<a class="el" href="or_8hpp.html#a9de3b2867e4ea8c08be077f49965cca8">__OR_DO__</a>(nul(__p))</td></tr>
<tr class="separator:acf4a66cacaf720f99688a39b9bb0c0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae12e2aec223b64cd45458f94488d10f1"><td class="memItemLeft" align="right" valign="top"><a id="ae12e2aec223b64cd45458f94488d10f1" name="ae12e2aec223b64cd45458f94488d10f1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>__OR__</b>(expr)&#160;&#160;&#160;<a class="el" href="or_8hpp.html#a9de3b2867e4ea8c08be077f49965cca8">__OR_DO__</a>(expr) return BY_WHEN</td></tr>
<tr class="separator:ae12e2aec223b64cd45458f94488d10f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3363ca4d6d3cc0230b2804280591c991"><td class="memItemLeft" align="right" valign="top"><a id="a3363ca4d6d3cc0230b2804280591c991" name="a3363ca4d6d3cc0230b2804280591c991"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OR</b>&#160;&#160;&#160;__OR__(nul(__p))</td></tr>
<tr class="separator:a3363ca4d6d3cc0230b2804280591c991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbff6aaba1facca85e946ecf3e5b21c6"><td class="memItemLeft" align="right" valign="top"><a id="adbff6aaba1facca85e946ecf3e5b21c6" name="adbff6aaba1facca85e946ecf3e5b21c6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OR_RET_CTOR</b>&#160;&#160;&#160;<a class="el" href="or_8hpp.html#a9de3b2867e4ea8c08be077f49965cca8">__OR_DO__</a>(nul(__p)) return</td></tr>
<tr class="separator:adbff6aaba1facca85e946ecf3e5b21c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94668caed3714aecacc608e0325dd7f5"><td class="memItemLeft" align="right" valign="top"><a id="a94668caed3714aecacc608e0325dd7f5" name="a94668caed3714aecacc608e0325dd7f5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>OR_CONTINUE</b>&#160;&#160;&#160;OR_DO continue</td></tr>
<tr class="separator:a94668caed3714aecacc608e0325dd7f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >OR macro implementation for error handling and fallback operations </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a9de3b2867e4ea8c08be077f49965cca8" name="a9de3b2867e4ea8c08be077f49965cca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de3b2867e4ea8c08be077f49965cca8">&#9670;&nbsp;</a></span>__OR_DO__</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __OR_DO__</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_expr_</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    | [&amp;](<span class="keyword">auto</span>&amp;&amp; __p) -&gt; <span class="keywordtype">void</span> {                       \</div>
<div class="line">        __orStack__::push(nul(__p) ? _expr_ : <span class="keyword">false</span>); \</div>
<div class="line">    };                                                \</div>
<div class="line">    if(__orStack__::pop())</div>
</div><!-- fragment --><p >OR macro: overview: It enables <code>return ?:</code>, a type of safe navigation in modern languages, in C++.</p>
<p >prerequisites: OR macro is based on <code>WHEN</code> macro. Before learning about OR, you need to know WHEN first.</p>
<p >usage: OR macro is used like this: <code>&lt;expr-evalution-as-pointer&gt; OR.&lt;when-expr&gt;</code></p>
<p >in this case, expr-evaluation-as-pointer must evaluate to a pointer type of a certain type. if not, a compilation error occurs. an expression using the WHEN macro is placed after OR, and is executed instead if the previous pointer was nullptr. if the pointer was not nullptr, it is returned as a reference. as a result, using the OR macro, you can safely perform nullcheck and handle non-null types.</p>
<p >example: int* foo();</p>
<p >int main() { // without OR: int* value = foo(); if(!value) return -1; return *value;</p>
<p >// with OR: int&amp; value = foo() OR.ret(-1) // If foo() returns nullptr, return -1. // now, you don't need to dereference <code>value</code> everytime! return value; }</p>
<p >the WHEN macro provides various methods in addition to simply returning an error. please check it if want to know more.</p>
<p >FAQ: Q. I want to use OR and also do casting as <code>(T&amp;)</code>. A. since OR's return type is reference, you may simply write some code like below. </p><pre class="fragment">class A {};
class B : public A {};

A* foo() { return new B(); }

int main() {
    B&amp; value = (A&amp;) foo() OR.ret(-1); // &lt;-- but a compile error occurs here.
    return 0;
}
</pre><p >the reason is that, as mentioned earlier, the left side of OR must always be a pointer. therefore, it should not be <code>(T&amp;)</code> but <code>(T*)</code>. this is correct codes.</p>
<p >int main() { B&amp; value = (B*) foo() OR.ret(-1); // or you may use <code>auto&amp;</code> return 0; }</p>
<p >if you want to cast the final result of a <a class="el" href="to_8hpp.html#ab66a6cdf25aca4c8eeb667e884fc905a">TO()</a> chain to T&amp;, you must surround the entire <a class="el" href="to_8hpp.html#ab66a6cdf25aca4c8eeb667e884fc905a">TO()</a> chain with parentheses. </p><pre class="fragment">B&amp; value = (B*) (foo() TO(getA()) TO(getMayB())) OR.ret();
</pre><p >Q. Can I use OR after <code>return</code>? A. <code>OR</code> was created based on the precondition that it would be used when defining a variable. It cannot be used with the <code>return</code> keyword.</p>
<pre class="fragment">    Q. I used OR macro with auto&amp; and got `Non-const lvalue reference to...` error.
       my code is like below,

        auto&amp; ret = _sub[name].get() OR.ret();

    A. don't use auto keyword.
    the actual return type of `OR` macro could be `tmedium&lt;T&gt;` or `tstr` or `tweak`.
    it differs in context which you're using. it was specified in each operand class
    file, for instance, 'tstr.hpp'. and if you used OR macro which returns `tmedium`, it
    is implicitly returned as T&amp; through this class. therefore, unless you have a
    special situation where you want to use tmedium, specify the type directly instead
    of auto.

        MyClass&amp; ret = _sub[name].get() OR.ret();
        // or,
        tstr&lt;MyClass&gt; ret = youGetThisInstanceOnHeap() OR.ret();


    Q. I used OR in a function whose return type is tmay and initialized it with a T&amp;&amp;
    variable, but the value is strange.

        tmay&lt;A&gt; foo();
        A&amp;&amp; a = foo() OR.ret();

    A. TLDR; take rvalue with type `tmay&lt;A&gt;&amp;&amp;` just like rvalue reference to return type
    of the function.

        tmay&lt;A&gt;&amp;&amp; a = foo();

    reason:
        foo() returns tmay by value. If you receive something returned by value as an
        rvalue reference, its life would be extended, but in this case, since it is not
        received as tmay&lt;A&gt;, the value inside it is taken out and returned, so the tmay
        temporary object does not extend its life and starts to die immediately. as a
        result, a garbage value is bound to `A&amp;&amp; a`. 
</pre> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>
